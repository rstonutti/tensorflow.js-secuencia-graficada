<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
    <script>
      // Entradas.
      const xs = tf.tensor([-5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5]);
      // Valor que toma para cada entrada.
      const ys = tf.tensor([-12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8]);

      // Creamos el modelo
      const modelo = tf.sequential();

      modelo.add(
        tf.layers.dense({
          inputShape: 1,
          units: 1,
        })
      );

      modelo.compile({
        optimizer: "sgd",
        loss: "meanSquaredError",
      });

      // Entrenamiento.
      modelo
        .fit(xs, ys, {
          epochs: 300,
        })
        .then((history) => {
          const incognitasTensor = tf.tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
          const [...salida] = modelo.predict(incognitasTensor).dataSync();

          console.log(salida);

          salida.map((num, i) => {
            console.log(
              `Para ${
                incognitasTensor.dataSync()[i]
              } el resultado es ${Math.round(num)}`
            );
          });

          salida.map((y, x) => ({ x, y }))

          const resultados = salida.map((y, x) => ({ x, y }));

          console.log(resultados);

          const series = ["y=2x-2"];
          const data = { values: [resultados], series };

          const surface = { name: "Recta Lineal", tab: "Resultados" };
          tfvis.render.linechart(surface, data);

          // Limpiamos los tensores.
          tf.dispose([xs, ys, modelo, salida, incognitasTensor]);
        });
    </script>
  </head>

  <body>
    <h1>Inspecciona el codigo!</h1>
  </body>
</html>
